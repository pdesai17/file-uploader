import { getContext } from "@llama-flow/core";

//#region src/middleware/store.ts
function withStore(createStore, workflow) {
	return {
		...workflow,
		getStore() {
			const context = getContext();
			return context.getStore();
		},
		createContext(input) {
			const currentStore = createStore(input);
			const context = workflow.createContext();
			context.__internal__call_context.subscribe((_, next) => {
				getContext().getStore = () => currentStore;
				next(_);
			});
			context.getStore = () => currentStore;
			return context;
		}
	};
}

//#endregion
export { withStore };
//# sourceMappingURL=store.js.map